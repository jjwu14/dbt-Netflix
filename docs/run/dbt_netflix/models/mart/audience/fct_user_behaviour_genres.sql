-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into MOVIELENS.DEV.fct_user_behaviour_genres as DBT_INTERNAL_DEST
        using MOVIELENS.DEV.fct_user_behaviour_genres__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.rating_id = DBT_INTERNAL_DEST.rating_id))

    
    when matched then update set
        "RATING_ID" = DBT_INTERNAL_SOURCE."RATING_ID","USER_ID" = DBT_INTERNAL_SOURCE."USER_ID","MOVIE_ID" = DBT_INTERNAL_SOURCE."MOVIE_ID","RATING" = DBT_INTERNAL_SOURCE."RATING","GENRE_NAME" = DBT_INTERNAL_SOURCE."GENRE_NAME","RATING_TIMESTAMP" = DBT_INTERNAL_SOURCE."RATING_TIMESTAMP","ENGAGEMENT_LEVEL" = DBT_INTERNAL_SOURCE."ENGAGEMENT_LEVEL","USER_TOTAL_RATINGS" = DBT_INTERNAL_SOURCE."USER_TOTAL_RATINGS","USER_OVERALL_AVG_RATING" = DBT_INTERNAL_SOURCE."USER_OVERALL_AVG_RATING","RATED_YEAR" = DBT_INTERNAL_SOURCE."RATED_YEAR","RATED_MONTH" = DBT_INTERNAL_SOURCE."RATED_MONTH","RATED_DAY_OF_MONTH" = DBT_INTERNAL_SOURCE."RATED_DAY_OF_MONTH","RATED_DAY_OF_WEEK" = DBT_INTERNAL_SOURCE."RATED_DAY_OF_WEEK"
    

    when not matched then insert
        ("RATING_ID", "USER_ID", "MOVIE_ID", "RATING", "GENRE_NAME", "RATING_TIMESTAMP", "ENGAGEMENT_LEVEL", "USER_TOTAL_RATINGS", "USER_OVERALL_AVG_RATING", "RATED_YEAR", "RATED_MONTH", "RATED_DAY_OF_MONTH", "RATED_DAY_OF_WEEK")
    values
        ("RATING_ID", "USER_ID", "MOVIE_ID", "RATING", "GENRE_NAME", "RATING_TIMESTAMP", "ENGAGEMENT_LEVEL", "USER_TOTAL_RATINGS", "USER_OVERALL_AVG_RATING", "RATED_YEAR", "RATED_MONTH", "RATED_DAY_OF_MONTH", "RATED_DAY_OF_WEEK")

;
    commit;