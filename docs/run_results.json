{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.9", "generated_at": "2025-09-03T18:50:47.609667Z", "invocation_id": "003ddd88-0e91-4cc1-bac5-d5f11e670423", "invocation_started_at": "2025-09-03T18:50:44.126931Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.224558Z", "completed_at": "2025-09-03T18:50:47.234884Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.235351Z", "completed_at": "2025-09-03T18:50:47.235368Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011661052703857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.src_genome_scores", "compiled": true, "compiled_code": "WITH raw_genome_scores AS (\n  SELECT * FROM MOVIELENS.RAW.RAW_GENOME_SCORES\n)\n\nSELECT\n  movieId AS movie_id,\n  tagId AS tag_id,\n  relevance\nFROM raw_genome_scores", "relation_name": "MOVIELENS.DEV.src_genome_scores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.237061Z", "completed_at": "2025-09-03T18:50:47.240034Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.240292Z", "completed_at": "2025-09-03T18:50:47.240300Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003990888595581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.src_genome_tags", "compiled": true, "compiled_code": "WITH raw_genome_tags AS (\n  SELECT * FROM MOVIELENS.RAW.RAW_GENOME_TAGS\n)\n\nSELECT\n  tagId AS tag_id,\n  tag\nFROM raw_genome_tags", "relation_name": "MOVIELENS.DEV.src_genome_tags", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.241614Z", "completed_at": "2025-09-03T18:50:47.245011Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.245221Z", "completed_at": "2025-09-03T18:50:47.245227Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004230976104736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.src_links", "compiled": true, "compiled_code": "WITH raw_links AS (\n  SELECT * FROM MOVIELENS.RAW.RAW_LINKS\n)\n\nSELECT\n  movieId AS movie_id,\n  imdbId AS imdb_id,\n  tmdbId AS tmdb_id\nFROM raw_links", "relation_name": "MOVIELENS.DEV.src_links", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.246252Z", "completed_at": "2025-09-03T18:50:47.248217Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.248422Z", "completed_at": "2025-09-03T18:50:47.248426Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026357173919677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.src_movies", "compiled": true, "compiled_code": "WITH raw_movies AS (\n    SELECT * FROM MOVIELENS.RAW.RAW_MOVIES\n)\nSELECT \n    movieId AS movie_id,\n    title,\n    genres\nFROM raw_movies", "relation_name": "MOVIELENS.DEV.src_movies", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.249390Z", "completed_at": "2025-09-03T18:50:47.251205Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.251387Z", "completed_at": "2025-09-03T18:50:47.251391Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025038719177246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.src_ratings", "compiled": true, "compiled_code": "\n\nWITH raw_ratings AS (\n    SELECT * \n    FROM MOVIELENS.RAW.RAW_RATINGS\n)\n\nSELECT\n    userId AS user_id,\n    movieId AS movie_id,\n    rating,\n    TO_TIMESTAMP_LTZ(timestamp) AS rating_timestamp\nFROM raw_ratings\nWHERE TO_TIMESTAMP_LTZ(timestamp) >= '2010-01-01'", "relation_name": "MOVIELENS.DEV.src_ratings", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.252380Z", "completed_at": "2025-09-03T18:50:47.253936Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.254110Z", "completed_at": "2025-09-03T18:50:47.254113Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0021619796752929688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.src_tags", "compiled": true, "compiled_code": "WITH raw_tags AS (\n  SELECT * FROM MOVIELENS.RAW.RAW_TAGS\n)\n\nSELECT\n  userId AS user_id,\n  movieId AS movie_id,\n  tag,\n  TO_TIMESTAMP_LTZ(timestamp) AS tag_timestamp\nFROM raw_tags", "relation_name": "MOVIELENS.DEV.src_tags", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.254937Z", "completed_at": "2025-09-03T18:50:47.255752Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.255930Z", "completed_at": "2025-09-03T18:50:47.255933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001348257064819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_netflix.recommendation_categories", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.256720Z", "completed_at": "2025-09-03T18:50:47.262759Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.262910Z", "completed_at": "2025-09-03T18:50:47.262913Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006556272506713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_genome_scores_MOVIEID.c1358e67fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect MOVIEID\nfrom MOVIELENS.RAW.RAW_GENOME_SCORES\nwhere MOVIEID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.263650Z", "completed_at": "2025-09-03T18:50:47.265469Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.265622Z", "completed_at": "2025-09-03T18:50:47.265625Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023148059844970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_genome_scores_RELEVANCE.fe62514e79", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect RELEVANCE\nfrom MOVIELENS.RAW.RAW_GENOME_SCORES\nwhere RELEVANCE is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.266334Z", "completed_at": "2025-09-03T18:50:47.268176Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.268323Z", "completed_at": "2025-09-03T18:50:47.268326Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002321958541870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_genome_scores_TAGID.7fccf3e85b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TAGID\nfrom MOVIELENS.RAW.RAW_GENOME_SCORES\nwhere TAGID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.268990Z", "completed_at": "2025-09-03T18:50:47.270598Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.270734Z", "completed_at": "2025-09-03T18:50:47.270736Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002044200897216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_genome_tags_TAG.7c40f821cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TAG\nfrom MOVIELENS.RAW.RAW_GENOME_TAGS\nwhere TAG is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.271383Z", "completed_at": "2025-09-03T18:50:47.273783Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.273926Z", "completed_at": "2025-09-03T18:50:47.273929Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0028498172760009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_genome_tags_TAGID.3b0bf9e7a5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TAGID\nfrom MOVIELENS.RAW.RAW_GENOME_TAGS\nwhere TAGID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.274575Z", "completed_at": "2025-09-03T18:50:47.276147Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.276275Z", "completed_at": "2025-09-03T18:50:47.276278Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001997709274291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_links_MOVIEID.a0df1557fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect MOVIEID\nfrom MOVIELENS.RAW.RAW_LINKS\nwhere MOVIEID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.276894Z", "completed_at": "2025-09-03T18:50:47.278376Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.278505Z", "completed_at": "2025-09-03T18:50:47.278507Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001898050308227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_movies_MOVIEID.9deb61f7d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect MOVIEID\nfrom MOVIELENS.RAW.RAW_MOVIES\nwhere MOVIEID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.279110Z", "completed_at": "2025-09-03T18:50:47.280575Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.280693Z", "completed_at": "2025-09-03T18:50:47.280695Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018639564514160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_movies_TITLE.68ca34ad23", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TITLE\nfrom MOVIELENS.RAW.RAW_MOVIES\nwhere TITLE is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.281268Z", "completed_at": "2025-09-03T18:50:47.282732Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.282856Z", "completed_at": "2025-09-03T18:50:47.282858Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001867055892944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_ratings_MOVIEID.bd6b71684e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect MOVIEID\nfrom MOVIELENS.RAW.RAW_RATINGS\nwhere MOVIEID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.283433Z", "completed_at": "2025-09-03T18:50:47.284806Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.284927Z", "completed_at": "2025-09-03T18:50:47.284929Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001760721206665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_ratings_RATING.5d53f9763b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect RATING\nfrom MOVIELENS.RAW.RAW_RATINGS\nwhere RATING is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.285505Z", "completed_at": "2025-09-03T18:50:47.286870Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.286986Z", "completed_at": "2025-09-03T18:50:47.286988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001749277114868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_ratings_TIMESTAMP.7f22872bf4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TIMESTAMP\nfrom MOVIELENS.RAW.RAW_RATINGS\nwhere TIMESTAMP is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.287535Z", "completed_at": "2025-09-03T18:50:47.288907Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.289029Z", "completed_at": "2025-09-03T18:50:47.289031Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017478466033935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_ratings_USERID.6abe1a8a60", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect USERID\nfrom MOVIELENS.RAW.RAW_RATINGS\nwhere USERID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.289568Z", "completed_at": "2025-09-03T18:50:47.290902Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.291020Z", "completed_at": "2025-09-03T18:50:47.291022Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017099380493164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_not_null_movielens_raw_tags_TAG.883b467f8e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TAG\nfrom MOVIELENS.RAW.RAW_TAGS\nwhere TAG is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.291585Z", "completed_at": "2025-09-03T18:50:47.295175Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.295295Z", "completed_at": "2025-09-03T18:50:47.295297Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003972768783569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_relationships_movielens_raw_ratings_MOVIEID__MOVIEID__source_movielens_raw_movies_.8043c153fa", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select MOVIEID as from_field\n    from MOVIELENS.RAW.RAW_RATINGS\n    where MOVIEID is not null\n),\n\nparent as (\n    select MOVIEID as to_field\n    from MOVIELENS.RAW.RAW_MOVIES\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.295859Z", "completed_at": "2025-09-03T18:50:47.297455Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.297568Z", "completed_at": "2025-09-03T18:50:47.297570Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019698143005371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_relevance_range_movielens_raw_genome_scores_RELEVANCE.9d54c2d8ab", "compiled": true, "compiled_code": "\n\nselect *\nfrom MOVIELENS.RAW.RAW_GENOME_SCORES\nwhere RELEVANCE < 0 or RELEVANCE > 1\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.298237Z", "completed_at": "2025-09-03T18:50:47.300613Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.300736Z", "completed_at": "2025-09-03T18:50:47.300739Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0028769969940185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_unique_movielens_raw_genome_tags_TAGID.09eedc4d0f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    TAGID as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.RAW.RAW_GENOME_TAGS\nwhere TAGID is not null\ngroup by TAGID\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.301297Z", "completed_at": "2025-09-03T18:50:47.302933Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.303048Z", "completed_at": "2025-09-03T18:50:47.303050Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002005338668823242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_unique_movielens_raw_links_MOVIEID.8f47d8fae4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    MOVIEID as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.RAW.RAW_LINKS\nwhere MOVIEID is not null\ngroup by MOVIEID\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.303587Z", "completed_at": "2025-09-03T18:50:47.304886Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.304996Z", "completed_at": "2025-09-03T18:50:47.304998Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016589164733886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.source_unique_movielens_raw_movies_MOVIEID.6bf86963cb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    MOVIEID as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.RAW.RAW_MOVIES\nwhere MOVIEID is not null\ngroup by MOVIEID\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.305530Z", "completed_at": "2025-09-03T18:50:47.306680Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.306786Z", "completed_at": "2025-09-03T18:50:47.306788Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015041828155517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.int_movie_tag_relevance", "compiled": true, "compiled_code": "\n\nselect\n  s.movie_id,\n  t.tag_id,\n  t.tag,\n  s.relevance\nfrom MOVIELENS.DEV.src_genome_scores s\njoin MOVIELENS.DEV.src_genome_tags t\n  on s.tag_id = t.tag_id", "relation_name": "MOVIELENS.DEV.int_movie_tag_relevance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.307354Z", "completed_at": "2025-09-03T18:50:47.308356Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.308465Z", "completed_at": "2025-09-03T18:50:47.308466Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0013890266418457031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.int_movie_genres", "compiled": true, "compiled_code": "\n\n\nwith movie_genres AS (\n    SELECT movie_id, \n           TRIM(value) AS genre_name\n    FROM MOVIELENS.DEV.src_movies,\n    lateral flatten(input => split(genres, '|'))\n) \n\nselect\n    *\nfrom movie_genres", "relation_name": "MOVIELENS.DEV.int_movie_genres", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.309014Z", "completed_at": "2025-09-03T18:50:47.310042Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.310152Z", "completed_at": "2025-09-03T18:50:47.310154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0013821125030517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.int_movie_genres_concat", "compiled": true, "compiled_code": "\n\n\nwith movie_genres AS (\n    SELECT movie_id, \n           TRIM(value) AS genre_name\n    FROM MOVIELENS.DEV.src_movies,\n    lateral flatten(input => split(genres, '|'))\n) \n\nselect\n    movie_id,\n    listagg(distinct genre_name, ', ') within group (order by genre_name) as genres_string\nfrom movie_genres\ngroup by 1", "relation_name": "MOVIELENS.DEV.int_movie_genres_concat", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.310705Z", "completed_at": "2025-09-03T18:50:47.311679Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.311791Z", "completed_at": "2025-09-03T18:50:47.311793Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0013518333435058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.int_movie_rating_stats", "compiled": true, "compiled_code": "\n\nselect\n  movie_id,\n  count(*) as rating_count,\n  count(distinct user_id) as unique_raters,\n  avg(rating) as avg_rating\nfrom MOVIELENS.DEV.src_ratings\ngroup by 1", "relation_name": "MOVIELENS.DEV.int_movie_rating_stats", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.312344Z", "completed_at": "2025-09-03T18:50:47.316136Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.316255Z", "completed_at": "2025-09-03T18:50:47.316257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004180192947387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.int_user_daily_ratings", "compiled": true, "compiled_code": "\n\nselect\n    user_id,\n    date(rating_timestamp) as rating_date,\n    count(movie_id) as daily_ratings_count,\n    avg(rating) as daily_avg_rating\nfrom MOVIELENS.DEV.src_ratings\n\n\nwhere date(rating_timestamp) > (select max(rating_date) from MOVIELENS.DEV.int_user_daily_ratings)\n\n\ngroup by 1, 2\norder by 1, 2", "relation_name": "MOVIELENS.DEV.int_user_daily_ratings", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.316815Z", "completed_at": "2025-09-03T18:50:47.317818Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.317926Z", "completed_at": "2025-09-03T18:50:47.317928Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0013737678527832031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.int_user_profiles", "compiled": true, "compiled_code": "\n\nwith user_ratings_summary as (\n    select\n        user_id,\n        count(movie_id) as total_ratings,\n        avg(rating) as overall_avg_rating\n    from MOVIELENS.DEV.src_ratings\n    group by 1\n),\n\n-- rank users by total_ratings for percentile calculation\nranked_users as (\n    select\n        user_id,\n        total_ratings,\n        overall_avg_rating,\n        percent_rank() over (order by total_ratings) as pct_rank\n    from user_ratings_summary\n)\n\nselect\n    user_id,\n    total_ratings,\n    overall_avg_rating,\n    case\n        when pct_rank >= 0.95 then 'Super-High-Engagement'   -- top 5% of users\n        when pct_rank >= 0.66 then 'High-Engagement'        -- next ~29%\n        when pct_rank >= 0.33 then 'Medium-Engagement'      -- next ~33%\n        else 'Low-Engagement'                               -- bottom ~33%\n    end as engagement_level\nfrom ranked_users", "relation_name": "MOVIELENS.DEV.int_user_profiles", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.318478Z", "completed_at": "2025-09-03T18:50:47.319889Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.319998Z", "completed_at": "2025-09-03T18:50:47.320000Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017850399017333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.int_movie_top_tags", "compiled": true, "compiled_code": "\n\nselect\n    r.movie_id,\n    r.tag_id,\n    r.tag,\n    r.relevance\nfrom MOVIELENS.DEV.int_movie_tag_relevance r\nqualify \nrow_number() over (partition by r.movie_id order by r.relevance desc) <= 10\n", "relation_name": "MOVIELENS.DEV.int_movie_top_tags", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.320530Z", "completed_at": "2025-09-03T18:50:47.321804Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.321899Z", "completed_at": "2025-09-03T18:50:47.321901Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016360282897949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_tag_relevance_movie_id.33b96f4dc1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.int_movie_tag_relevance\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.322405Z", "completed_at": "2025-09-03T18:50:47.323654Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.323748Z", "completed_at": "2025-09-03T18:50:47.323750Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015747547149658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_tag_relevance_relevance.41a38cad81", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect relevance\nfrom MOVIELENS.DEV.int_movie_tag_relevance\nwhere relevance is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.324226Z", "completed_at": "2025-09-03T18:50:47.325344Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.325440Z", "completed_at": "2025-09-03T18:50:47.325442Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014309883117675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_tag_relevance_tag.91f35f6e5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tag\nfrom MOVIELENS.DEV.int_movie_tag_relevance\nwhere tag is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.325915Z", "completed_at": "2025-09-03T18:50:47.327068Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.327163Z", "completed_at": "2025-09-03T18:50:47.327165Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001461029052734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_tag_relevance_tag_id.e654e9f6b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tag_id\nfrom MOVIELENS.DEV.int_movie_tag_relevance\nwhere tag_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.327643Z", "completed_at": "2025-09-03T18:50:47.328730Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.328828Z", "completed_at": "2025-09-03T18:50:47.328830Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014019012451171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.relevance_range_int_movie_tag_relevance_relevance.d4b2c4dc8b", "compiled": true, "compiled_code": "\n\nselect *\nfrom MOVIELENS.DEV.int_movie_tag_relevance\nwhere relevance < 0 or relevance > 1\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.329303Z", "completed_at": "2025-09-03T18:50:47.330411Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.330520Z", "completed_at": "2025-09-03T18:50:47.330522Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014309883117675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_genres_genre_name.8a65e92f7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect genre_name\nfrom MOVIELENS.DEV.int_movie_genres\nwhere genre_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.330998Z", "completed_at": "2025-09-03T18:50:47.332888Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.332986Z", "completed_at": "2025-09-03T18:50:47.332988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0022039413452148438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_genres_movie_id.f977763002", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.int_movie_genres\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.333468Z", "completed_at": "2025-09-03T18:50:47.335039Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.335140Z", "completed_at": "2025-09-03T18:50:47.335141Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018897056579589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.relationships_int_movie_genres_movie_id__movie_id__ref_src_movies_.2a5a08c74e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select movie_id as from_field\n    from MOVIELENS.DEV.int_movie_genres\n    where movie_id is not null\n),\n\nparent as (\n    select movie_id as to_field\n    from MOVIELENS.DEV.src_movies\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.337088Z", "completed_at": "2025-09-03T18:50:47.338259Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.338356Z", "completed_at": "2025-09-03T18:50:47.338358Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015358924865722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_genres_concat_genres_string.7611560f78", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect genres_string\nfrom MOVIELENS.DEV.int_movie_genres_concat\nwhere genres_string is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.338835Z", "completed_at": "2025-09-03T18:50:47.339918Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.340016Z", "completed_at": "2025-09-03T18:50:47.340018Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001399993896484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_genres_concat_movie_id.48aa0a05fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.int_movie_genres_concat\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.340503Z", "completed_at": "2025-09-03T18:50:47.341876Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.341977Z", "completed_at": "2025-09-03T18:50:47.341978Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016932487487792969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.relationships_int_movie_genres_concat_movie_id__movie_id__ref_src_movies_.01382684bf", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select movie_id as from_field\n    from MOVIELENS.DEV.int_movie_genres_concat\n    where movie_id is not null\n),\n\nparent as (\n    select movie_id as to_field\n    from MOVIELENS.DEV.src_movies\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.342454Z", "completed_at": "2025-09-03T18:50:47.343590Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.343693Z", "completed_at": "2025-09-03T18:50:47.343694Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014531612396240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_int_movie_genres_concat_movie_id.593d247154", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    movie_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.DEV.int_movie_genres_concat\nwhere movie_id is not null\ngroup by movie_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.344217Z", "completed_at": "2025-09-03T18:50:47.345176Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.345275Z", "completed_at": "2025-09-03T18:50:47.345276Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0013208389282226562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.int_movie_recommendation", "compiled": true, "compiled_code": "\n\nwith rating_stats as (\n    select *\n    from MOVIELENS.DEV.int_movie_rating_stats\n),\n\nrules as (\n    select * from MOVIELENS.DEV.recommendation_categories\n),\n\nall_matched_categories as (\n    select\n        r.movie_id,\n        r.rating_count,\n        r.avg_rating,\n        rules.category,\n        rules.priority\n    from rating_stats r\n    cross join rules\n    where r.rating_count >= rules.min_ratings\n      and r.avg_rating >= rules.avg_rating_threshold\n),\n\nranked as (\n    select\n        *,\n        row_number() over (\n            partition by movie_id\n            order by priority desc, category asc\n        ) as rn\n    from all_matched_categories\n)\n\nselect\n    movie_id,\n    rating_count,\n    avg_rating,\n    category as recommendation_category\nfrom ranked\nwhere rn = 1", "relation_name": "MOVIELENS.DEV.int_movie_recommendation", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.345821Z", "completed_at": "2025-09-03T18:50:47.346963Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.347059Z", "completed_at": "2025-09-03T18:50:47.347061Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015108585357666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_rating_stats_avg_rating.d25c37d276", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_rating\nfrom MOVIELENS.DEV.int_movie_rating_stats\nwhere avg_rating is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.347532Z", "completed_at": "2025-09-03T18:50:47.349323Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.349424Z", "completed_at": "2025-09-03T18:50:47.349425Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0021049976348876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_rating_stats_movie_id.f192948fc2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.int_movie_rating_stats\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.349902Z", "completed_at": "2025-09-03T18:50:47.350989Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.351088Z", "completed_at": "2025-09-03T18:50:47.351089Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001399993896484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_rating_stats_rating_count.01edeff7d9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating_count\nfrom MOVIELENS.DEV.int_movie_rating_stats\nwhere rating_count is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.351565Z", "completed_at": "2025-09-03T18:50:47.352653Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.352755Z", "completed_at": "2025-09-03T18:50:47.352757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014028549194335938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_rating_stats_unique_raters.4c9632672d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_raters\nfrom MOVIELENS.DEV.int_movie_rating_stats\nwhere unique_raters is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.353232Z", "completed_at": "2025-09-03T18:50:47.354318Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.354429Z", "completed_at": "2025-09-03T18:50:47.354431Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014150142669677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_int_movie_rating_stats_movie_id.05b11c37ac", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    movie_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.DEV.int_movie_rating_stats\nwhere movie_id is not null\ngroup by movie_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.354992Z", "completed_at": "2025-09-03T18:50:47.356087Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.356184Z", "completed_at": "2025-09-03T18:50:47.356186Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014829635620117188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_user_daily_ratings_daily_avg_rating.3218eddb55", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect daily_avg_rating\nfrom MOVIELENS.DEV.int_user_daily_ratings\nwhere daily_avg_rating is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.356650Z", "completed_at": "2025-09-03T18:50:47.357751Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.357848Z", "completed_at": "2025-09-03T18:50:47.357849Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014140605926513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_user_daily_ratings_daily_ratings_count.940103e88e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect daily_ratings_count\nfrom MOVIELENS.DEV.int_user_daily_ratings\nwhere daily_ratings_count is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.358322Z", "completed_at": "2025-09-03T18:50:47.359401Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.359499Z", "completed_at": "2025-09-03T18:50:47.359501Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0013980865478515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_user_daily_ratings_rating_date.f64d9cdd58", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating_date\nfrom MOVIELENS.DEV.int_user_daily_ratings\nwhere rating_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.360005Z", "completed_at": "2025-09-03T18:50:47.361104Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.361199Z", "completed_at": "2025-09-03T18:50:47.361201Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014581680297851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_user_daily_ratings_user_id.d347d5d0f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom MOVIELENS.DEV.int_user_daily_ratings\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.361666Z", "completed_at": "2025-09-03T18:50:47.363252Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.363352Z", "completed_at": "2025-09-03T18:50:47.363354Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001905202865600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.relationships_int_user_daily_ratings_user_id__USERID__source_movielens_raw_ratings_.b551b191ee", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from MOVIELENS.DEV.int_user_daily_ratings\n    where user_id is not null\n),\n\nparent as (\n    select USERID as to_field\n    from MOVIELENS.RAW.RAW_RATINGS\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.363817Z", "completed_at": "2025-09-03T18:50:47.399054Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.399182Z", "completed_at": "2025-09-03T18:50:47.399185Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03559613227844238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.fct_user_behaviour_genres", "compiled": true, "compiled_code": "\n\nwith ratings as (\n    select\n        user_id,\n        movie_id,\n        rating,\n        rating_timestamp\n    from MOVIELENS.DEV.src_ratings\n    \n    where rating_timestamp > (\n        select coalesce(max(rating_timestamp), '1900-01-01')\n        from MOVIELENS.DEV.fct_user_behaviour_genres\n    )\n    \n),\n\nratings_with_user as (\n    select\n        r.*,\n        u.engagement_level,\n        u.total_ratings as user_total_ratings,\n        u.overall_avg_rating as user_overall_avg_rating\n    from ratings r\n    left join MOVIELENS.DEV.int_user_profiles u\n        on r.user_id = u.user_id\n),\n\nratings_with_genres as (\n    select\n        ru.*,\n        g.genre_name,\n        row_number() over (\n            partition by ru.user_id, ru.movie_id, ru.rating_timestamp\n            order by g.genre_name\n        ) as genre_rank\n    from ratings_with_user ru\n    left join MOVIELENS.DEV.int_movie_genres g\n        on ru.movie_id = g.movie_id\n),\n\nratings_enriched as (\n    select\n        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rating_timestamp as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(genre_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(genre_rank as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as rating_id,\n\n        user_id,\n        movie_id,\n        rating,\n        genre_name,\n        rating_timestamp,\n        engagement_level,\n        user_total_ratings,\n        user_overall_avg_rating,\n\n        year(rating_timestamp) as rated_year,\n        month(rating_timestamp) as rated_month,\n        day(rating_timestamp) as rated_day_of_month,\n        dayofweek(rating_timestamp) as rated_day_of_week\n    from ratings_with_genres\n)\n\nselect * \nfrom ratings_enriched", "relation_name": "MOVIELENS.DEV.fct_user_behaviour_genres", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.399802Z", "completed_at": "2025-09-03T18:50:47.401755Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.401861Z", "completed_at": "2025-09-03T18:50:47.401863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023620128631591797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.fct_user_behaviour_genres_concat", "compiled": true, "compiled_code": "\n\nwith ratings as (\n    select\n        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(movie_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rating_timestamp as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as rating_id,\n        user_id,\n        movie_id,\n        rating,\n        rating_timestamp\n    from MOVIELENS.DEV.src_ratings\n    \n    where rating_timestamp > (select coalesce(max(rating_timestamp), '1900-01-01') from MOVIELENS.DEV.fct_user_behaviour_genres_concat)\n    \n),\n\n\nratings_with_user as (\n    select\n        r.*,\n        u.engagement_level,\n        u.total_ratings as user_total_ratings,\n        u.overall_avg_rating as user_overall_avg_rating\n    from ratings r\n    left join MOVIELENS.DEV.int_user_profiles u\n        on r.user_id = u.user_id\n),\n\nratings_enriched as (\n    select\n        ru.rating_id,\n        ru.user_id,\n        ru.movie_id,\n        ru.rating,\n        g.genres_string,\n        ru.rating_timestamp,\n        ru.engagement_level,\n        ru.user_total_ratings,\n        ru.user_overall_avg_rating,\n        year(ru.rating_timestamp) as rated_year,\n        month(ru.rating_timestamp) as rated_month,\n        day(ru.rating_timestamp) as rated_day_of_month,\n        dayofweek(ru.rating_timestamp) as rated_day_of_week\n    from ratings_with_user ru\n    left join MOVIELENS.DEV.int_movie_genres_concat g\n        on ru.movie_id = g.movie_id\n)\n\nselect * \nfrom ratings_enriched", "relation_name": "MOVIELENS.DEV.fct_user_behaviour_genres_concat", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.402420Z", "completed_at": "2025-09-03T18:50:47.405587Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.405697Z", "completed_at": "2025-09-03T18:50:47.405699Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035600662231445312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.accepted_values_int_user_profiles_engagement_level__High_Engagement__Low_Engagement__Medium_Engagement__Super_High_Engagement.2b9a3b17dc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        engagement_level as value_field,\n        count(*) as n_records\n\n    from MOVIELENS.DEV.int_user_profiles\n    group by engagement_level\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'High-Engagement','Low-Engagement','Medium-Engagement','Super-High-Engagement'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.406248Z", "completed_at": "2025-09-03T18:50:47.407519Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.407617Z", "completed_at": "2025-09-03T18:50:47.407619Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015990734100341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_user_profiles_engagement_level.e3f03cb87b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_level\nfrom MOVIELENS.DEV.int_user_profiles\nwhere engagement_level is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.408084Z", "completed_at": "2025-09-03T18:50:47.409242Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.409335Z", "completed_at": "2025-09-03T18:50:47.409337Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001470327377319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_user_profiles_user_id.c617dc39db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom MOVIELENS.DEV.int_user_profiles\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.409826Z", "completed_at": "2025-09-03T18:50:47.411446Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.411560Z", "completed_at": "2025-09-03T18:50:47.411562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001977205276489258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.relationships_int_user_profiles_user_id__user_id__ref_src_ratings_.fc374e48ee", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from MOVIELENS.DEV.int_user_profiles\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from MOVIELENS.DEV.src_ratings\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.412116Z", "completed_at": "2025-09-03T18:50:47.413215Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.413309Z", "completed_at": "2025-09-03T18:50:47.413311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014200210571289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_int_user_profiles_user_id.eb4689b1e1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.DEV.int_user_profiles\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.413788Z", "completed_at": "2025-09-03T18:50:47.414820Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.414913Z", "completed_at": "2025-09-03T18:50:47.414915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001341104507446289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.int_tag_movie_link", "compiled": true, "compiled_code": "\n\n-- Only keep movies with enough ratings\nwith filtered_movies as (\n    select *\n    from MOVIELENS.DEV.int_movie_rating_stats\n    where rating_count >= 20\n)\n\nselect distinct\n    t.movie_id,\n    t.tag_id,\n    t.tag,\n    t.relevance\nfrom MOVIELENS.DEV.int_movie_top_tags t\njoin filtered_movies m\n    on t.movie_id = m.movie_id", "relation_name": "MOVIELENS.DEV.int_tag_movie_link", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.415416Z", "completed_at": "2025-09-03T18:50:47.417163Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.417265Z", "completed_at": "2025-09-03T18:50:47.417267Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002087831497192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_top_tags_movie_id.90510e5e07", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.int_movie_top_tags\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.417794Z", "completed_at": "2025-09-03T18:50:47.418913Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.419019Z", "completed_at": "2025-09-03T18:50:47.419020Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014929771423339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_top_tags_relevance.e3930143cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect relevance\nfrom MOVIELENS.DEV.int_movie_top_tags\nwhere relevance is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.419545Z", "completed_at": "2025-09-03T18:50:47.420710Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.420807Z", "completed_at": "2025-09-03T18:50:47.420809Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014951229095458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_top_tags_tag.38286c8c6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tag\nfrom MOVIELENS.DEV.int_movie_top_tags\nwhere tag is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.421279Z", "completed_at": "2025-09-03T18:50:47.422384Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.422495Z", "completed_at": "2025-09-03T18:50:47.422497Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014352798461914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_top_tags_tag_id.e2d7388a23", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tag_id\nfrom MOVIELENS.DEV.int_movie_top_tags\nwhere tag_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.423005Z", "completed_at": "2025-09-03T18:50:47.424455Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.424551Z", "completed_at": "2025-09-03T18:50:47.424552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018019676208496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_details_genres_string.eac1aae403", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_movie_details as (\n\n\nselect\n    movies.movie_id,\n    movies.title,\n    genres.genres_string\nfrom MOVIELENS.DEV.src_movies as movies\njoin MOVIELENS.DEV.int_movie_genres_concat as genres\n    on movies.movie_id = genres.movie_id\n) select genres_string\nfrom __dbt__cte__int_movie_details\nwhere genres_string is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.425024Z", "completed_at": "2025-09-03T18:50:47.426370Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.426463Z", "completed_at": "2025-09-03T18:50:47.426465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016510486602783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_details_movie_id.441e5509b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_movie_details as (\n\n\nselect\n    movies.movie_id,\n    movies.title,\n    genres.genres_string\nfrom MOVIELENS.DEV.src_movies as movies\njoin MOVIELENS.DEV.int_movie_genres_concat as genres\n    on movies.movie_id = genres.movie_id\n) select movie_id\nfrom __dbt__cte__int_movie_details\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.426940Z", "completed_at": "2025-09-03T18:50:47.428311Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.428404Z", "completed_at": "2025-09-03T18:50:47.428406Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001680135726928711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_details_title.4becc2249a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_movie_details as (\n\n\nselect\n    movies.movie_id,\n    movies.title,\n    genres.genres_string\nfrom MOVIELENS.DEV.src_movies as movies\njoin MOVIELENS.DEV.int_movie_genres_concat as genres\n    on movies.movie_id = genres.movie_id\n) select title\nfrom __dbt__cte__int_movie_details\nwhere title is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.428882Z", "completed_at": "2025-09-03T18:50:47.430494Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.430593Z", "completed_at": "2025-09-03T18:50:47.430595Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001920938491821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_int_movie_details_movie_id.3ff081b9d6", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_movie_details as (\n\n\nselect\n    movies.movie_id,\n    movies.title,\n    genres.genres_string\nfrom MOVIELENS.DEV.src_movies as movies\njoin MOVIELENS.DEV.int_movie_genres_concat as genres\n    on movies.movie_id = genres.movie_id\n) select\n    movie_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_movie_details\nwhere movie_id is not null\ngroup by movie_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.431086Z", "completed_at": "2025-09-03T18:50:47.433300Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.433401Z", "completed_at": "2025-09-03T18:50:47.433403Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002541780471801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.fct_movie_recommendations", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_movie_details as (\n\n\nselect\n    movies.movie_id,\n    movies.title,\n    genres.genres_string\nfrom MOVIELENS.DEV.src_movies as movies\njoin MOVIELENS.DEV.int_movie_genres_concat as genres\n    on movies.movie_id = genres.movie_id\n) select\n    c.movie_id,\n    d.title,\n    d.genres_string,\n    c.rating_count,\n    c.avg_rating,\n    c.recommendation_category\nfrom MOVIELENS.DEV.int_movie_recommendation c\njoin __dbt__cte__int_movie_details d\n    on c.movie_id = d.movie_id", "relation_name": "MOVIELENS.DEV.fct_movie_recommendations", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.433948Z", "completed_at": "2025-09-03T18:50:47.435741Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.435841Z", "completed_at": "2025-09-03T18:50:47.435843Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002154827117919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.accepted_values_int_movie_recommendation_recommendation_category__evergreen__rising_star__fading.2e4fa43f99", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        recommendation_category as value_field,\n        count(*) as n_records\n\n    from MOVIELENS.DEV.int_movie_recommendation\n    group by recommendation_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'evergreen','rising_star','fading'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.436363Z", "completed_at": "2025-09-03T18:50:47.437493Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.437590Z", "completed_at": "2025-09-03T18:50:47.437592Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014681816101074219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_recommendation_avg_rating.7d4719fc3d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_rating\nfrom MOVIELENS.DEV.int_movie_recommendation\nwhere avg_rating is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.438062Z", "completed_at": "2025-09-03T18:50:47.439231Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.439332Z", "completed_at": "2025-09-03T18:50:47.439334Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014851093292236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_recommendation_movie_id.71115535ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.int_movie_recommendation\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.439804Z", "completed_at": "2025-09-03T18:50:47.440875Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.440971Z", "completed_at": "2025-09-03T18:50:47.440973Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0013821125030517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_recommendation_rating_count.4309869a13", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating_count\nfrom MOVIELENS.DEV.int_movie_recommendation\nwhere rating_count is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.441451Z", "completed_at": "2025-09-03T18:50:47.442554Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.442652Z", "completed_at": "2025-09-03T18:50:47.442653Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014200210571289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_movie_recommendation_recommendation_category.1482d4503f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recommendation_category\nfrom MOVIELENS.DEV.int_movie_recommendation\nwhere recommendation_category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.443129Z", "completed_at": "2025-09-03T18:50:47.444057Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.444152Z", "completed_at": "2025-09-03T18:50:47.444154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0012388229370117188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.test_movie_recommendation_logic", "compiled": true, "compiled_code": "select\n    r.movie_id\nfrom MOVIELENS.DEV.int_movie_recommendation r\nleft join MOVIELENS.DEV.recommendation_categories c\n    on r.recommendation_category = c.category\nwhere r.recommendation_category <> 'unclassified'\nand (\n    r.rating_count < c.min_ratings\n    or r.avg_rating < c.avg_rating_threshold\n)", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.444623Z", "completed_at": "2025-09-03T18:50:47.445713Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.445809Z", "completed_at": "2025-09-03T18:50:47.445811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014007091522216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_int_movie_recommendation_movie_id.ea6630385d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    movie_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.DEV.int_movie_recommendation\nwhere movie_id is not null\ngroup by movie_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.446323Z", "completed_at": "2025-09-03T18:50:47.447495Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.447600Z", "completed_at": "2025-09-03T18:50:47.447602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001516103744506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_netflix.top_5_genres_high_engagement", "compiled": true, "compiled_code": "SELECT\n    genre_name AS genre,\n    COUNT(rating) AS total_ratings_count,\n    AVG(rating) AS average_rating\nFROM MOVIELENS.DEV.fct_user_behaviour_genres\nWHERE engagement_level = 'High-Engagement'\nGROUP BY 1\nORDER BY\n    total_ratings_count DESC,\n    average_rating DESC\nLIMIT 5", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.448082Z", "completed_at": "2025-09-03T18:50:47.449194Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.449290Z", "completed_at": "2025-09-03T18:50:47.449292Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014209747314453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_genre_name.4282a20d90", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect genre_name\nfrom MOVIELENS.DEV.fct_user_behaviour_genres\nwhere genre_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.450432Z", "completed_at": "2025-09-03T18:50:47.451553Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.451650Z", "completed_at": "2025-09-03T18:50:47.451651Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002115011215209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_movie_id.d1de9148bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.fct_user_behaviour_genres\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.452121Z", "completed_at": "2025-09-03T18:50:47.453231Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.453329Z", "completed_at": "2025-09-03T18:50:47.453331Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014290809631347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_rating.2dd32cf3b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating\nfrom MOVIELENS.DEV.fct_user_behaviour_genres\nwhere rating is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.453843Z", "completed_at": "2025-09-03T18:50:47.454968Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.455065Z", "completed_at": "2025-09-03T18:50:47.455067Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014603137969970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_rating_id.3bd8f62766", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating_id\nfrom MOVIELENS.DEV.fct_user_behaviour_genres\nwhere rating_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.455576Z", "completed_at": "2025-09-03T18:50:47.456665Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.456762Z", "completed_at": "2025-09-03T18:50:47.456764Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014469623565673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_rating_timestamp.3a8c765732", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating_timestamp\nfrom MOVIELENS.DEV.fct_user_behaviour_genres\nwhere rating_timestamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.457248Z", "completed_at": "2025-09-03T18:50:47.458351Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.458445Z", "completed_at": "2025-09-03T18:50:47.458447Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014388561248779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_user_id.7071938dfc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom MOVIELENS.DEV.fct_user_behaviour_genres\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.458898Z", "completed_at": "2025-09-03T18:50:47.460003Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.460098Z", "completed_at": "2025-09-03T18:50:47.460100Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014100074768066406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_fct_user_behaviour_genres_rating_id.a7be3e4018", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rating_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.DEV.fct_user_behaviour_genres\nwhere rating_id is not null\ngroup by rating_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.460556Z", "completed_at": "2025-09-03T18:50:47.461427Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.461524Z", "completed_at": "2025-09-03T18:50:47.461526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001180887222290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_netflix.top_5_grouped_genres_high_engagement", "compiled": true, "compiled_code": "SELECT\n    genres_string AS genre,\n    COUNT(rating) AS total_ratings_count,\n    AVG(rating) AS average_rating\nFROM MOVIELENS.DEV.fct_user_behaviour_genres_concat\nWHERE engagement_level = 'High-Engagement'\nGROUP BY 1\nORDER BY\n    total_ratings_count DESC,\n    average_rating DESC\nLIMIT 5", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.461986Z", "completed_at": "2025-09-03T18:50:47.463135Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.463231Z", "completed_at": "2025-09-03T18:50:47.463232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014579296112060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_concat_movie_id.f7712a1ef4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.fct_user_behaviour_genres_concat\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.463696Z", "completed_at": "2025-09-03T18:50:47.464809Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.464921Z", "completed_at": "2025-09-03T18:50:47.464923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014421939849853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_concat_rating.8e61267b6e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating\nfrom MOVIELENS.DEV.fct_user_behaviour_genres_concat\nwhere rating is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.465423Z", "completed_at": "2025-09-03T18:50:47.467211Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.467309Z", "completed_at": "2025-09-03T18:50:47.467311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0021049976348876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_concat_rating_id.bb47231e12", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating_id\nfrom MOVIELENS.DEV.fct_user_behaviour_genres_concat\nwhere rating_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.467776Z", "completed_at": "2025-09-03T18:50:47.468874Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.468972Z", "completed_at": "2025-09-03T18:50:47.468973Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014159679412841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_concat_rating_timestamp.b68288a04c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating_timestamp\nfrom MOVIELENS.DEV.fct_user_behaviour_genres_concat\nwhere rating_timestamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.469479Z", "completed_at": "2025-09-03T18:50:47.470578Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.470672Z", "completed_at": "2025-09-03T18:50:47.470673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001428842544555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_user_behaviour_genres_concat_user_id.24273d4998", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom MOVIELENS.DEV.fct_user_behaviour_genres_concat\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.471138Z", "completed_at": "2025-09-03T18:50:47.472638Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.472739Z", "completed_at": "2025-09-03T18:50:47.472741Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018181800842285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.relationships_fct_user_behaviour_genres_concat_movie_id__movie_id__ref_src_movies_.2e333a43e1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select movie_id as from_field\n    from MOVIELENS.DEV.fct_user_behaviour_genres_concat\n    where movie_id is not null\n),\n\nparent as (\n    select movie_id as to_field\n    from MOVIELENS.DEV.src_movies\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.473210Z", "completed_at": "2025-09-03T18:50:47.474635Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.474733Z", "completed_at": "2025-09-03T18:50:47.474735Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017440319061279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.relationships_fct_user_behaviour_genres_concat_user_id__user_id__ref_int_user_profiles_.fed8b3455c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from MOVIELENS.DEV.fct_user_behaviour_genres_concat\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from MOVIELENS.DEV.int_user_profiles\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.475216Z", "completed_at": "2025-09-03T18:50:47.476331Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.476436Z", "completed_at": "2025-09-03T18:50:47.476437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014460086822509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_fct_user_behaviour_genres_concat_rating_id.802a56ff53", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    rating_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.DEV.fct_user_behaviour_genres_concat\nwhere rating_id is not null\ngroup by rating_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.476903Z", "completed_at": "2025-09-03T18:50:47.477900Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.477997Z", "completed_at": "2025-09-03T18:50:47.477999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0013082027435302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.dim_movie_tag_profile", "compiled": true, "compiled_code": "\n\nwith top_tags as (\n    select *\n    from MOVIELENS.DEV.int_tag_movie_link\n),\nranked as (\n    select\n        tt.movie_id,\n        tt.tag_id,\n        tt.tag,\n        tt.relevance,\n        row_number() over (partition by tt.movie_id order by tt.relevance desc) as tag_rank\n    from top_tags tt\n),\nagg as (\n    select\n        movie_id,\n        listagg(tag, ', ') within group (order by tag_rank) as top_tags_list\n    from ranked\n    group by movie_id\n)\nselect\n    m.MOVIE_ID as movie_id,\n    m.TITLE as title,\n    a.top_tags_list\nfrom agg a\njoin MOVIELENS.DEV.src_movies m\n    on a.movie_id = m.MOVIE_ID", "relation_name": "MOVIELENS.DEV.dim_movie_tag_profile", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.478524Z", "completed_at": "2025-09-03T18:50:47.479608Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.479702Z", "completed_at": "2025-09-03T18:50:47.479703Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014350414276123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_netflix.fct_tag_performance", "compiled": true, "compiled_code": "\n\nwith movie_stats as (\n    select \n        movie_id,\n        rating_count,\n        unique_raters,\n        avg_rating\n    from MOVIELENS.DEV.int_movie_rating_stats\n),\nmovie_tags as (\n    select distinct movie_id, tag_id, tag\n    from MOVIELENS.DEV.int_tag_movie_link\n),\ntag_join as (\n    select\n        mt.tag_id,\n        mt.tag,\n        ms.movie_id,\n        ms.rating_count,\n        ms.unique_raters,\n        ms.avg_rating\n    from movie_tags mt\n    join movie_stats ms\n        on mt.movie_id = ms.movie_id\n),\nby_tag as (\n    select\n        tag_id,\n        min(tag) as tag,\n        count(distinct movie_id) as movies_with_tag,\n        sum(rating_count) as total_ratings_on_tagged_movies,\n        sum(avg_rating * rating_count) / nullif(sum(rating_count),0) as weighted_avg_rating\n    from tag_join\n    group by tag_id\n)\nselect *\nfrom by_tag\nwhere movies_with_tag >= 50\norder by weighted_avg_rating desc nulls last", "relation_name": "MOVIELENS.DEV.fct_tag_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.480234Z", "completed_at": "2025-09-03T18:50:47.481415Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.481526Z", "completed_at": "2025-09-03T18:50:47.481528Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015652179718017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_tag_movie_link_movie_id.96e69e7c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.int_tag_movie_link\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.481994Z", "completed_at": "2025-09-03T18:50:47.483794Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.483894Z", "completed_at": "2025-09-03T18:50:47.483896Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002112865447998047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_tag_movie_link_relevance.382849e54a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect relevance\nfrom MOVIELENS.DEV.int_tag_movie_link\nwhere relevance is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.484352Z", "completed_at": "2025-09-03T18:50:47.485518Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.485612Z", "completed_at": "2025-09-03T18:50:47.485613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014719963073730469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_tag_movie_link_tag.50fe4e6a65", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tag\nfrom MOVIELENS.DEV.int_tag_movie_link\nwhere tag is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.486065Z", "completed_at": "2025-09-03T18:50:47.487162Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.487257Z", "completed_at": "2025-09-03T18:50:47.487259Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001402139663696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_int_tag_movie_link_tag_id.b34a65051f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tag_id\nfrom MOVIELENS.DEV.int_tag_movie_link\nwhere tag_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.487716Z", "completed_at": "2025-09-03T18:50:47.493551Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.493652Z", "completed_at": "2025-09-03T18:50:47.493654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006154060363769531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_netflix.top_5_movies_by_category", "compiled": true, "compiled_code": "-- This analysis identifies trends in movie recommendation categories,\n-- highlights top movies and genres, and helps track rising stars, evergreen hits, and fading movies.\n-- Useful for content acquisition, marketing, and recommendation strategy.\n\n-- Latest recommendation category per movie\nWITH  __dbt__cte__int_movie_details as (\n\n\nselect\n    movies.movie_id,\n    movies.title,\n    genres.genres_string\nfrom MOVIELENS.DEV.src_movies as movies\njoin MOVIELENS.DEV.int_movie_genres_concat as genres\n    on movies.movie_id = genres.movie_id\n), latest_recs AS (\n    SELECT \n        movie_id,\n        recommendation_category\n    FROM MOVIELENS.DEV.fct_movie_recommendations\n),\n\n-- Enrich with movie details\ngenre_enriched AS (\n    SELECT\n        m.movie_id,\n        m.title,\n        m.genres_string,\n        l.recommendation_category\n    FROM latest_recs l\n    JOIN __dbt__cte__int_movie_details m\n        ON l.movie_id = m.movie_id\n),\n\n-- Summary of categories\ncategory_summary AS (\n    SELECT\n        g.recommendation_category,\n        COUNT(g.movie_id) AS total_movies,\n        AVG(r.rating_count) AS avg_rating_count,\n        AVG(r.avg_rating) AS avg_movie_rating\n    FROM genre_enriched g\n    JOIN MOVIELENS.DEV.int_movie_rating_stats r\n        ON g.movie_id = r.movie_id\n    GROUP BY g.recommendation_category\n),\n\n-- Top 10 movies per recommendation category\ntop_movies AS (\n    SELECT\n        g.movie_id,\n        g.title,\n        g.genres_string,\n        g.recommendation_category,\n        r.rating_count,\n        r.avg_rating,\n        ROW_NUMBER() OVER (\n            PARTITION BY g.recommendation_category\n            ORDER BY r.avg_rating DESC, r.rating_count DESC\n        ) AS rn\n    FROM genre_enriched g\n    JOIN MOVIELENS.DEV.int_movie_rating_stats r\n        ON g.movie_id = r.movie_id\n    QUALIFY rn <= 10\n)\n\n-- Final output combining summaries and top movies\nSELECT\n    'Category Summary' AS analysis_section,\n    recommendation_category,\n    total_movies,\n    avg_rating_count,\n    avg_movie_rating,\n    NULL AS movie_id,\n    NULL AS title,\n    NULL AS genres_string,\n    NULL AS rating_count,\n    NULL AS avg_rating\nFROM category_summary\n\nUNION ALL\n\nSELECT\n    'Top Movies' AS analysis_section,\n    recommendation_category,\n    NULL AS total_movies,\n    NULL AS avg_rating_count,\n    NULL AS avg_movie_rating,\n    movie_id,\n    title,\n    genres_string,\n    rating_count,\n    avg_rating\nFROM top_movies\nORDER BY analysis_section, recommendation_category;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.494131Z", "completed_at": "2025-09-03T18:50:47.495003Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.495108Z", "completed_at": "2025-09-03T18:50:47.495109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0011966228485107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_netflix.movie_recommendations_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect\n    movie_id,\n    recommendation_category\nfrom MOVIELENS.DEV.fct_movie_recommendations\n", "relation_name": "MOVIELENS.snapshots.movie_recommendations_snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.495663Z", "completed_at": "2025-09-03T18:50:47.496874Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.496971Z", "completed_at": "2025-09-03T18:50:47.496973Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015778541564941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.accepted_values_fct_movie_recommendations_recommendation_category__evergreen__rising_star__fading.60c432a929", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        recommendation_category as value_field,\n        count(*) as n_records\n\n    from MOVIELENS.DEV.fct_movie_recommendations\n    group by recommendation_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'evergreen','rising_star','fading'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.497429Z", "completed_at": "2025-09-03T18:50:47.498605Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.498702Z", "completed_at": "2025-09-03T18:50:47.498703Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014848709106445312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_movie_recommendations_avg_rating.16df28ea01", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_rating\nfrom MOVIELENS.DEV.fct_movie_recommendations\nwhere avg_rating is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.499172Z", "completed_at": "2025-09-03T18:50:47.500317Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.500421Z", "completed_at": "2025-09-03T18:50:47.500423Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014646053314208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_movie_recommendations_genres_string.ac86e6c9e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect genres_string\nfrom MOVIELENS.DEV.fct_movie_recommendations\nwhere genres_string is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.500890Z", "completed_at": "2025-09-03T18:50:47.502788Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.502887Z", "completed_at": "2025-09-03T18:50:47.502889Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0022089481353759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_movie_recommendations_movie_id.b874332edd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.fct_movie_recommendations\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.503352Z", "completed_at": "2025-09-03T18:50:47.504539Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.504631Z", "completed_at": "2025-09-03T18:50:47.504633Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014929771423339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_movie_recommendations_rating_count.e70a3ba04a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rating_count\nfrom MOVIELENS.DEV.fct_movie_recommendations\nwhere rating_count is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.505092Z", "completed_at": "2025-09-03T18:50:47.506283Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.506399Z", "completed_at": "2025-09-03T18:50:47.506401Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015249252319335938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_movie_recommendations_recommendation_category.8252eb143a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recommendation_category\nfrom MOVIELENS.DEV.fct_movie_recommendations\nwhere recommendation_category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.506922Z", "completed_at": "2025-09-03T18:50:47.508027Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.508124Z", "completed_at": "2025-09-03T18:50:47.508125Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014388561248779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_movie_recommendations_title.ddb1b67c96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect title\nfrom MOVIELENS.DEV.fct_movie_recommendations\nwhere title is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.508585Z", "completed_at": "2025-09-03T18:50:47.509754Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.509854Z", "completed_at": "2025-09-03T18:50:47.509856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001486063003540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_fct_movie_recommendations_movie_id.d47284a284", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    movie_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.DEV.fct_movie_recommendations\nwhere movie_id is not null\ngroup by movie_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.510366Z", "completed_at": "2025-09-03T18:50:47.511468Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.511564Z", "completed_at": "2025-09-03T18:50:47.511566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014340877532958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_dim_movie_tag_profile_movie_id.1c7efcc0b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.DEV.dim_movie_tag_profile\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.512020Z", "completed_at": "2025-09-03T18:50:47.513115Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.513212Z", "completed_at": "2025-09-03T18:50:47.513214Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014047622680664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_dim_movie_tag_profile_title.e145ea00e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect title\nfrom MOVIELENS.DEV.dim_movie_tag_profile\nwhere title is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.513678Z", "completed_at": "2025-09-03T18:50:47.514844Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.514943Z", "completed_at": "2025-09-03T18:50:47.514944Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014767646789550781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_dim_movie_tag_profile_top_tags_list.c0e63cb0b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect top_tags_list\nfrom MOVIELENS.DEV.dim_movie_tag_profile\nwhere top_tags_list is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.515394Z", "completed_at": "2025-09-03T18:50:47.516495Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.516589Z", "completed_at": "2025-09-03T18:50:47.516591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014081001281738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_dim_movie_tag_profile_movie_id.2a48a3a5f2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    movie_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.DEV.dim_movie_tag_profile\nwhere movie_id is not null\ngroup by movie_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.517041Z", "completed_at": "2025-09-03T18:50:47.518782Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.518880Z", "completed_at": "2025-09-03T18:50:47.518881Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020470619201660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_tag_performance_movies_with_tag.905b0a71aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movies_with_tag\nfrom MOVIELENS.DEV.fct_tag_performance\nwhere movies_with_tag is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.519338Z", "completed_at": "2025-09-03T18:50:47.520529Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.520642Z", "completed_at": "2025-09-03T18:50:47.520644Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015187263488769531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_tag_performance_tag.acb9dced0a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tag\nfrom MOVIELENS.DEV.fct_tag_performance\nwhere tag is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.521116Z", "completed_at": "2025-09-03T18:50:47.522222Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.522317Z", "completed_at": "2025-09-03T18:50:47.522319Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014171600341796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_tag_performance_tag_id.a1b40ccaf6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tag_id\nfrom MOVIELENS.DEV.fct_tag_performance\nwhere tag_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.522785Z", "completed_at": "2025-09-03T18:50:47.523891Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.523997Z", "completed_at": "2025-09-03T18:50:47.523999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014281272888183594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_tag_performance_total_ratings_on_tagged_movies.8287f7208b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_ratings_on_tagged_movies\nfrom MOVIELENS.DEV.fct_tag_performance\nwhere total_ratings_on_tagged_movies is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.524506Z", "completed_at": "2025-09-03T18:50:47.525647Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.525747Z", "completed_at": "2025-09-03T18:50:47.525749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014820098876953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_fct_tag_performance_weighted_avg_rating.d790127460", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect weighted_avg_rating\nfrom MOVIELENS.DEV.fct_tag_performance\nwhere weighted_avg_rating is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.526227Z", "completed_at": "2025-09-03T18:50:47.527325Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.527422Z", "completed_at": "2025-09-03T18:50:47.527423Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001405954360961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_fct_tag_performance_tag_id.258ee50601", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    tag_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.DEV.fct_tag_performance\nwhere tag_id is not null\ngroup by tag_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.527903Z", "completed_at": "2025-09-03T18:50:47.529036Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.529132Z", "completed_at": "2025-09-03T18:50:47.529133Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014531612396240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_movie_recommendations_snapshot_dbt_scd_id.9a09b34d59", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_scd_id\nfrom MOVIELENS.snapshots.movie_recommendations_snapshot\nwhere dbt_scd_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.529657Z", "completed_at": "2025-09-03T18:50:47.530825Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.530932Z", "completed_at": "2025-09-03T18:50:47.530933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015180110931396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_movie_recommendations_snapshot_dbt_valid_from.12b7096ab0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_valid_from\nfrom MOVIELENS.snapshots.movie_recommendations_snapshot\nwhere dbt_valid_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.531407Z", "completed_at": "2025-09-03T18:50:47.532507Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.532605Z", "completed_at": "2025-09-03T18:50:47.532607Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014128684997558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.not_null_movie_recommendations_snapshot_movie_id.73e2ba75e9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect movie_id\nfrom MOVIELENS.snapshots.movie_recommendations_snapshot\nwhere movie_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-03T18:50:47.533082Z", "completed_at": "2025-09-03T18:50:47.534786Z"}, {"name": "execute", "started_at": "2025-09-03T18:50:47.534880Z", "completed_at": "2025-09-03T18:50:47.534882Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020112991333007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_netflix.unique_movie_recommendations_snapshot_dbt_scd_id.aa71483edf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    dbt_scd_id as unique_field,\n    count(*) as n_records\n\nfrom MOVIELENS.snapshots.movie_recommendations_snapshot\nwhere dbt_scd_id is not null\ngroup by dbt_scd_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 3.1609017848968506, "args": {"partial_parse": true, "strict_mode": false, "require_generic_test_arguments_property": true, "require_resource_names_without_spaces": true, "quiet": false, "defer": false, "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "exclude": [], "require_batched_execution_for_custom_microbatch_strategy": false, "invocation_command": "dbt docs generate", "static": false, "macro_debugging": false, "select": [], "cache_selected_only": false, "state_modified_compare_vars": false, "log_format_file": "debug", "version_check": true, "upload_to_artifacts_ingest_api": false, "require_all_warnings_handled_by_warn_error": false, "introspect": true, "log_level_file": "debug", "favor_state": false, "compile": true, "validate_macro_args": false, "log_path": "/Users/jwu/course/dbt_netflix/logs", "warn_error_options": {"error": [], "warn": [], "silence": []}, "print": true, "printer_width": 80, "log_level": "info", "require_yaml_configuration_for_mf_time_spines": false, "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "send_anonymous_usage_stats": true, "use_colors": true, "use_fast_test_edges": false, "project_dir": "/Users/jwu/course/dbt_netflix", "require_nested_cumulative_type_params": false, "vars": {}, "write_json": true, "empty_catalog": false, "log_format": "default", "show_all_deprecations": false, "which": "generate", "profiles_dir": "/Users/jwu/.dbt", "show_resource_report": false, "partial_parse_file_diff": true, "use_colors_file": true, "populate_cache": true, "source_freshness_run_project_hooks": true, "log_file_max_bytes": 10485760, "indirect_selection": "eager"}}