# test all pased 

version: 2

models:
  - name: int_movie_genres_concat
    description: "Aggregated genres per movie, concatenated into a single string."
    columns:
      - name: movie_id
        description: "Unique identifier for each movie"
        tests:
          - not_null
          - unique
          - relationships:
              to: ref('src_movies')
              field: movie_id
      - name: genres_string
        description: "Concatenated string of genres for the movie, separated by commas"
        tests:
          - not_null

  - name: int_movie_genres
    description: "Identifies unique movie and their genres, each row represents a movie with its associated per genre."
    columns:
      - name: movie_id
        description: "Unique identifier for each movie"
        tests:
          - not_null
          - relationships:
              to: ref('src_movies')
              field: movie_id
      - name: genre_name
        description: "Single genre associated with the movie"
        tests:
          - not_null
  - name: int_user_daily_ratings
    description: "Aggregates user rating data on a daily basis to track user activity over time."
    columns:
      - name: user_id
        description: "The unique identifier of the user."
        tests:
          - not_null
      - name: rating_date
        description: "The date the ratings were given."
        tests:
          - not_null
      - name: daily_ratings_count
        description: "The total number of ratings a user submitted on a given day."
        tests:
          - not_null
      - name: daily_avg_rating
        description: "The average rating given by a user on a given day."
        tests:
          - not_null
    
  - name: int_user_profiles
    description: "User-level attributes derived from ratings, including engagement levels."
    columns:
      - name: user_id
        description: "Unique identifier for each user"
        tests:
          - not_null
          - unique
          - relationships:
              to: ref('src_ratings')
              field: user_id
      - name: total_ratings
        description: "Total number of ratings given by the user"
      - name: overall_avg_rating
        description: "Average rating given by the user across all movies"
      - name: engagement_level
        description: "User engagement category"
        tests:
          - not_null
          - accepted_values:
              values: ['High-Engagement', 'Medium-Engagement', 'Low-Engagement']
  - name: int_movie_details
    description: "Intermediate model that combines essential movie metadata (title, genres) into a single table for downstream use."
    columns:
      - name: movie_id
        description: "The unique identifier of the movie."
        tests:
          - not_null
          - unique
      - name: title
        description: "The title of the movie."
        tests:
          - not_null
      - name: genres_string
        description: "A single, concatenated string of all genres for the movie."
        tests:
          - not_null
